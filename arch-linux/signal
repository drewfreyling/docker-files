# DO NOT MODIFY THIS AUTOGENERATED FILE
# Change it in m4 folder
FROM sandrokeil/archlinux:latest
RUN echo "[multilib]" >> /etc/pacman.conf \
    && echo "Include = /etc/pacman.d/mirrorlist" >> /etc/pacman.conf \
    && pacman -Sly multilib \
    && pacman -Sy --noconfirm gconf gtk2 libnotify libxtst nss xdg-utils libxss
RUN pacman -Sy --noconfirm sudo fakeroot patch gzip git gcc make pkg-config diffutils file \
    && useradd builduser -m \
    && passwd -d builduser \
    && printf "builduser ALL=(ALL) ALL\n" | tee -a /etc/sudoers \
    && sudo -u builduser bash -c "mkdir -p ~/tmp && curl -L https://aur.archlinux.org/cgit/aur.git/snapshot/signal-desktop-bin.tar.gz | tar xzf - --strip-components=1 -C ~/tmp" \
    && sudo -u builduser bash -c "cd ~/tmp && makepkg -si --noconfirm " \
    && userdel -r builduser \
    && pacman -Rs --noconfirm git gcc make \
    && pacman -Scc --noconfirm 
ENTRYPOINT ["signal-desktop"]
